{"version":3,"file":"server.js","names":["express","require","app","path","url","MongoClient","client","useNewUrlParser","db","issueListfromServer","collection","find","toArray","issues","connectToDb","database_name","connect","console","log","fileServerMiddlewareconst","static","join","__dirname","use","listen"],"sources":["server.ts"],"sourcesContent":["// Importar express http server\r\nconst express = require(\"express\");\r\n\r\n// crear aplicacion express\r\nconst app = express();\r\n\r\n// para usar el absolute path de una aplicacion\r\nconst path = require(\"path\");\r\n\r\n//const url = `mongodb://localhost:27017/`;\r\nconst url = `mongodb://0.0.0.0:27017/`;\r\n//const url = `mongodb://172.17.0.2:27017/`;\r\n\r\n// Mongodb Atlas connection string\r\n//const url = `mongodb+srv://admin:Ji9vfIASQ7NnFwN8@cluster0.30imzhm.mongodb.net`;\r\n\r\nconst MongoClient = require(\"mongodb\").MongoClient;\r\nconst client = new MongoClient(url, { useNewUrlParser: true });\r\n\r\nlet db: any;\r\n\r\nexport async function issueListfromServer() {\r\n  const issues = await db.collection(\"issues\").find({}).toArray();\r\n  return issues;\r\n}\r\n\r\nasync function connectToDb(database_name: string) {\r\n  await client.connect();\r\n  console.log(\"Connected to MongoDB at\", url);\r\n  db = client.db(database_name);\r\n}\r\n\r\n// funcion de express static para acceder al contenido de una carpeta\r\n//console.log(path.join(__dirname, 'public'));\r\nconst fileServerMiddlewareconst = express.static(\r\n  path.join(__dirname, \"..\", \"public\")\r\n); // _dirname/.. me deja en la carpeta raiz\r\n\r\n// usar dicha carpeta\r\napp.use(\"/\", fileServerMiddlewareconst);\r\n\r\n// start server en puerto 3000\r\n(async function () {\r\n  try {\r\n    await connectToDb(\"issuetracker\");\r\n    app.listen(3000, function () {\r\n      console.log(\"App started on port 3000\");\r\n    });\r\n  } catch (err) {\r\n    console.log(\"ERROR:\", err);\r\n  }\r\n})();\r\n"],"mappings":";;;;;;;+CACA;AAAA;AAAA;AADA;AACA,IAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;;AAElC;AACA,IAAMC,GAAG,GAAGF,OAAO,EAAE;;AAErB;AACA,IAAMG,IAAI,GAAGF,OAAO,CAAC,MAAM,CAAC;;AAE5B;AACA,IAAMG,GAAG,6BAA6B;AACtC;;AAEA;AACA;;AAEA,IAAMC,WAAW,GAAGJ,OAAO,CAAC,SAAS,CAAC,CAACI,WAAW;AAClD,IAAMC,MAAM,GAAG,IAAID,WAAW,CAACD,GAAG,EAAE;EAAEG,eAAe,EAAE;AAAK,CAAC,CAAC;AAE9D,IAAIC,EAAO;AAAC,SAEUC,mBAAmB;EAAA;AAAA;AAAA;EAAA,kFAAlC;IAAA;IAAA;MAAA;QAAA;UAAA;UAAA,OACgBD,EAAE,CAACE,UAAU,CAAC,QAAQ,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC,CAAC,CAACC,OAAO,EAAE;QAAA;UAAzDC,MAAM;UAAA,kCACLA,MAAM;QAAA;QAAA;UAAA;MAAA;IAAA;EAAA,CACd;EAAA;AAAA;AAAA,SAEcC,WAAW;EAAA;AAAA,EAM1B;AACA;AAAA;EAAA,0EAPA,kBAA2BC,aAAqB;IAAA;MAAA;QAAA;UAAA;UAAA,OACxCT,MAAM,CAACU,OAAO,EAAE;QAAA;UACtBC,OAAO,CAACC,GAAG,CAAC,yBAAyB,EAAEd,GAAG,CAAC;UAC3CI,EAAE,GAAGF,MAAM,CAACE,EAAE,CAACO,aAAa,CAAC;QAAC;QAAA;UAAA;MAAA;IAAA;EAAA,CAC/B;EAAA;AAAA;AAID,IAAMI,yBAAyB,GAAGnB,OAAO,CAACoB,MAAM,CAC9CjB,IAAI,CAACkB,IAAI,CAACC,SAAS,EAAE,IAAI,EAAE,QAAQ,CAAC,CACrC,CAAC,CAAC;;AAEH;AACApB,GAAG,CAACqB,GAAG,CAAC,GAAG,EAAEJ,yBAAyB,CAAC;;AAEvC;AACA,2DAAC;EAAA;IAAA;MAAA;QAAA;QAAA;QAAA,OAESL,WAAW,CAAC,cAAc,CAAC;MAAA;QACjCZ,GAAG,CAACsB,MAAM,CAAC,IAAI,EAAE,YAAY;UAC3BP,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC;QACzC,CAAC,CAAC;QAAC;QAAA;MAAA;QAAA;QAAA;QAEHD,OAAO,CAACC,GAAG,CAAC,QAAQ,cAAM;MAAC;MAAA;QAAA;IAAA;EAAA;AAAA,CAE9B,IAAG"}